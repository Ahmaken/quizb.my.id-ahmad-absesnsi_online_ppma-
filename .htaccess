# PWA Support
<IfModule mod_headers.c>
    # Service Worker
    <Files "sw.js">
        Header set Service-Worker-Allowed "/"
        Header set Cache-Control "no-cache, no-store, must-revalidate"
        Header set Content-Type "application/javascript"
    </Files>
    
    # Manifest
    <Files "manifest.json">
        Header set Cache-Control "no-cache"
        Header set Content-Type "application/json"
    </Files>
    
    # HTML files
    <Files "*.html">
        Header set Cache-Control "no-cache"
    </Files>
    
    # Icons and static assets (cache longer)
    <FilesMatch "\.(png|jpg|jpeg|gif|ico|svg|css|js)$">
        Header set Cache-Control "max-age=2592000, public"
    </FilesMatch>
</IfModule>

# HTTPS Redirect (wajib untuk PWA)
RewriteEngine On

# Redirect to HTTPS
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Route all requests to index.php for SPA-like experience
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php [QSA,L]